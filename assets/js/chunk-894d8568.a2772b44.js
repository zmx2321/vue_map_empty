(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-894d8568"],{"0d58":function(e,t,o){"use strict";o("eae8")},4571:function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("section",{staticClass:"main_cont"},[o("div",{staticClass:"filter_wrap"},[o("el-button",{attrs:{type:"primary"},on:{click:e.resetMap}},[e._v("初始化")]),o("el-select",{attrs:{placeholder:"请选择城市"},on:{change:e.selectName},model:{value:e.selCityName,callback:function(t){e.selCityName=t},expression:"selCityName"}},e._l(e.cityArr,(function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),o("GeojsonMap",{ref:"geojsonmap",on:{getcityArray:e.getcityArray,getGeoJsonData:e.getGeoJsonData}}),o("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[o("span",[e._v("这是一段信息")]),o("p",[e._v("城市名称："+e._s(e.cityName))]),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogVisible=!1,e.resetForm()}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1,e.saveForm()}}},[e._v("确 定")])],1)])],1)},a=[],i=(o("159b"),o("b0c0"),function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("section",{staticClass:"amap-wrapper"},[o("el-amap",{ref:"map",staticClass:"amap-box",attrs:{vid:"amap-vue",center:e.center,zoom:e.zoom,events:e.events}})],1)}),s=[],r={name:"geojsonmap",props:{},components:{},data:function(){var e=this;return{center:[107.943579,30.131735],zoom:7,events:{init:function(t){window.amapview=t,e.getGeoJson()}},polygonInitColor:"#f00",polygonMarkerColor:"#00f",globalGeoJsonData:{}}},computed:{},methods:{initGeojsonLayer:function(e,t){return new AMap.GeoJSON({geoJSON:e,getPolygon:function(e,o){var n=AMap.GeometryUtil.ringArea(o[0]);return new AMap.Polygon({path:o,fillOpacity:1-Math.sqrt(n/8e9),fillColor:t,strokeColor:"#fff",strokeWeight:.6,strokeStyle:"solid",strokeOpacity:1})}})},jumpToGeojson:function(){window.amapview.setZoom(this.zoom),window.amapview.setCenter(this.center)},initGeojsonPolygon:function(){var e=window.amapview.getAllOverlays("polygon");window.amapview.remove(e)},resetMap:function(){this.jumpToGeojson(),this.initGeojsonPolygon(),this.setGeojsonMap(this.globalGeoJsonData)},getGeoJson:function(){var e=this;this.axios.get("https://a.amap.com/jsapi_demos/static/geojson/chongqing.json").then((function(t){var o=t.data;e.globalGeoJsonData=o,e.$emit("getcityArray",o),e.setGeojsonMap(o),e.$message.success("geojson加载成功")})).catch({})},setGeoJsonLayer:function(e,t,o,n){var a=this.initGeojsonLayer(e,t);a.setMap(window.amapview),a.eachOverlay((function(e){e.on(o,(function(t){n(t,e)}))}))},setGeojsonMap:function(e){var t=this;this.setGeoJsonLayer(e,this.polygonInitColor,"click",(function(e,o){t.resetMap(),t.getGeoEvent(e,o,(function(e){t.getGeoJsonData(e)}))}))},getGeoEvent:function(e,t,o){var n=t.toGeoJSON();o(n);var a=this.initGeojsonLayer(n,this.polygonMarkerColor);a.setMap(window.amapview),this.geojsonEvent(a,(function(){}))},geojsonEvent:function(e,t){e.on("mouseout",(function(t){e.hide()})),e.on("click",(function(){console.log("鼠标点击事件"),e.hide(),t()}))},getGeoJsonData:function(e){var t="";t="string"===typeof e?e:e.properties.name,this.$emit("getGeoJsonData",t)},selectName:function(e){var t=this;this.resetMap();var o={};this.globalGeoJsonData.features.forEach((function(n){var a=t.initGeojsonLayer(n,t.polygonMarkerColor);n.properties.name===e&&(o=a,t.geojsonEvent(a,(function(){t.getGeoJsonData(e)})))})),window.amapview.add(o)}},created:function(){},mounted:function(){}},c=r,l=(o("ca4e"),o("2877")),u=Object(l["a"])(c,i,s,!1,null,"132b138f",null),p=u.exports,f={name:"testmap8",components:{GeojsonMap:p},data:function(){return{dialogVisible:!1,cityName:"",cityArr:[],selCityName:""}},computed:{},methods:{resetMap:function(){this.$refs.geojsonmap.resetMap(),this.resetForm()},resetForm:function(){this.selCityName=""},getcityArray:function(e){var t=this;e.features.forEach((function(e){t.cityArr.push({label:e.properties.name,value:e.properties.name})}))},getGeoJsonData:function(e){console.log("获取geojson数据 - 处理geojson业务流程",e),this.cityName=e,this.dialogVisible=!0},selectName:function(e){console.log(e),this.$refs.geojsonmap.selectName(e)},saveForm:function(){this.selCityName=this.cityName}},created:function(){},mounted:function(){}},m=f,g=(o("0d58"),Object(l["a"])(m,n,a,!1,null,"58c8ec1b",null));t["default"]=g.exports},"5a8f":function(e,t,o){},ca4e:function(e,t,o){"use strict";o("5a8f")},eae8:function(e,t,o){}}]);